
STATIC PRIVATE $FTypes AS NEW Collection

STATIC PROPERTY READ FTypes AS Collection
PROPERTY READ header AS CTagv2FrameHeader
PROPERTY READ description AS String

PRIVATE $header AS CTagv2FrameHeader

PUBLIC SUB _new(OPTIONAL header AS CTagv2FrameHeader = NULL)
  
  IF IsNull(header) THEN header = NEW CTagv2FrameHeader(NULL)
  $header = header
  
END

STATIC PUBLIC FUNCTION getFrame(header AS CTagv2FrameHeader, OPTIONAL rawData AS String = NULL) AS Object  

  DIM result AS Object
  
  IF Left(header.id) = "T" AND header.id <> "TXXX" THEN
    result = NEW CTagv2FrameText(header)
  ELSE IF Left(header.id) = "W" AND header.id <> "WXXX" THEN
    result = NEW CTagv2FrameURL(header)
  ELSE 
'     SELECT CASE header.id
'     END SELECT 
    result = NEW CTagv2Frame(header)
  END IF
  RETURN result
  
END

STATIC PRIVATE FUNCTION FTypes_Read() AS Collection
  RETURN $FTypes
END
PRIVATE FUNCTION header_Read() AS CTagv2FrameHeader
  RETURN $header
END
PRIVATE FUNCTION description_Read() AS String
  IF $FTypes.Exist($header.id) THEN RETURN $FTypes[$header.id]
  RETURN NULL
END

STATIC PUBLIC SUB _init()
  
  $FTypes.Add("Audio encryption", "AENC")
  $FTypes.Add("Attached picture", "APIC")
  $FTypes.Add("Audio seek point index", "ASPI")
  $FTypes.Add("Comments", "COMM")
  $FTypes.Add("Commercial frame", "COMR")
  $FTypes.Add("Encrypton method registration", "ENCR")
  $FTypes.Add("Equalisation (2)", "EQU2")
  $FTypes.Add("Event timing codes", "ETCO")
  $FTypes.Add("General encapsulated object", "GEOB")
  $FTypes.Add("Group identification registration", "GRID")
  $FTypes.Add("Linked information", "LINK")
  $FTypes.Add("Music CD identifier", "MCDI")
  $FTypes.Add("MPEG location lookup table", "MLLT")
  $FTypes.Add("Ownership frame", "OWNE")
  $FTypes.Add("Private frame", "PRIV")
  $FTypes.Add("Play counter", "PCNT")
  $FTypes.Add("Popularimenter", "POPM")
  $FTypes.Add("Position synchronisation frame", "POSS")
  $FTypes.Add("Recommended buffer size", "RBUF")
  $FTypes.Add("Relative volume adjustment (2)", "RVA2")
  $FTypes.Add("Reverb", "RVRB")
  $FTypes.Add("Seek frame", "SEEK")
  $FTypes.Add("Signature frame", "SIGN")
  $FTypes.Add("Synchronised lyric/text", "SYLT")
  $FTypes.Add("Synchronised tempo codes", "SYTC")
  $FTypes.Add("Unqiue file identifier", "UFID")
  $FTypes.Add("Terms of use", "USER")
  $FTypes.Add("Unsynchronised lyric/text transcription", "USLT")
  
END
